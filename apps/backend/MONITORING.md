# GrimOS Monitoring & API Gateway

This document provides an overview of the monitoring and API gateway setup for the GrimOS platform.

## Table of Contents

1. [Monitoring Stack](#monitoring-stack)
2. [API Gateway](#api-gateway)
3. [Getting Started](#getting-started)
4. [Configuration](#configuration)

## Monitoring Stack

The GrimOS monitoring stack includes the following components:

### Prometheus

[Prometheus](https://prometheus.io/) is used for metrics collection and storage. It scrapes metrics from our FastAPI backend and other services.

Key features:
- Time series database for storing metrics
- Built-in alerting capabilities
- Powerful PromQL query language for data analysis
- Service discovery for automatic target detection

### Grafana

[Grafana](https://grafana.com/) provides dashboarding and visualization for metrics collected by Prometheus.

Key features:
- Pre-configured dashboards for GrimOS API monitoring
- Real-time metrics visualization
- Alert management interface
- User authentication and access control

### Alertmanager

The Prometheus Alertmanager handles alerts generated by Prometheus rules.

Key features:
- Alert grouping and routing
- Notification throttling and silencing
- Integration with various notification channels (email, Slack, etc.)

### Node Exporter

Prometheus Node Exporter collects system-level metrics from the host machines.

## API Gateway

The GrimOS API Gateway uses [Kong](https://konghq.com/) as an API Gateway and management layer.

Key features:
- Route traffic to appropriate services
- Authentication and authorization with JWT
- Rate limiting to prevent abuse
- Request/response transformation
- Analytics and monitoring
- CORS support

### Konga

[Konga](https://github.com/pantsel/konga) is a UI for managing Kong.

Key features:
- Visual management of Kong entities
- Service and route management
- Plugin configuration
- Consumer management

## Getting Started

To start all services:

```bash
make all
```

To start only the monitoring stack:

```bash
make monitoring
```

To start only the API Gateway:

```bash
make kong
```

## Configuration

### Prometheus

Prometheus configuration is stored in `prometheus/prometheus.yml`. This defines metrics scraping targets and intervals.

### Grafana

Grafana dashboards are provisioned automatically from `grafana/provisioning/dashboards/`.

Default login:
- Username: admin
- Password: admin (configurable via environment variable)

### Kong

Kong is configured via the `kong/configure-kong.sh` script, which sets up:
- Services and routes for the GrimOS API
- JWT authentication for protected routes
- Rate limiting for API endpoints
- CORS configuration

Kong Admin UI (Konga) is available at `http://localhost:8002`

Default login (first time setup):
- Create an admin user during first login
